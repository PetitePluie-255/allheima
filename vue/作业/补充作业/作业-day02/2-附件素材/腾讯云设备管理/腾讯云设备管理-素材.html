<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>腾讯云设备管理</title>
    <link rel="stylesheet" href="./css/index.css">
</head>

<body>
    <div id="app">
        <!-- 左侧导航 -->
        <div class="nav">
            <div class="menu-item logo-head">
                <img class="logo" src="./images/tencent-cloud.svg" alt="">
            </div>
            <div class="menu-item">
                首页
            </div>
            <div class="menu-item">
                账号信息
            </div>
            <div class="menu-item">
                实名认证
            </div>
            <div class="menu-item">
                安全设置
            </div>
            <div class="menu-item active-route">
                设备管理
            </div>
            <div class="menu-item">
                应用服务授权
            </div>
            <div class="menu-item">
                访问管理
            </div>
            <div class="menu-item">
                系统信息
            </div>
        </div>
        <!-- 右侧内容 -->
        <div class="container">
            <!-- 头部 -->
            <div class="head-wrap">
                <div class="avtar">管</div>
                <div>订单</div>
                <div>备案</div>
                <div>工具</div>
                <div>费用</div>
            </div>
            <!-- 主体 -->
            <div class="content">
                <div class="title-wrap">
                    设备管理
                </div>
                <div class="equip-info">
                    <!-- 提示信息 -->
                    <div class="tip">
                        <span class="warning"></span>
                        说明：设备管理用于按管理云资源，可以对云资源进行管理和启用
                    </div>
                    <!-- 新增按钮 和 搜索框 -->
                    <div class="equip-btn-wrap">
                        <div class="btn-item fl">
                            <button class="add-btn" @click="showDialog=true">新建</button>
                        </div>
                        <div class="btn-item fl">
                            <input v-model="active" type="checkbox">
                            <span>全部启用</span>
                        </div>
                        <div class="btn-item fr">
                            <input type="text" v-model="value" class="search-input" @keyup.enter="search"
                                placeholder="请输入设备名称">
                            <div class="clear-btn" @click="cleanUp"></div>
                        </div>
                    </div>
                    <!-- 设备列表 -->
                    <div class="equip-card">
                        <div class="equip-head">
                            <div>设备名称</div>
                            <div>设备IP</div>
                            <div>设备说明</div>
                            <div>操作</div>
                        </div>
                        <div class="equip-list-wrap">
                            <table class="equip-list" v-if="true">
                                <tbody>
                                    <!-- 测试设备1 -->
                                    <tr v-for="item in equipList" :key="item.id">
                                        <td>
                                            {{item.name}}
                                            <span class="equip-id">（ID: 1697420179351）</span>
                                        </td>
                                        <td>这是一个{{item.enable?"启用":"停用"}}的设备</td>
                                        <td>{{item.ip}}</td>
                                        <td>
                                            <button @click="del(item.id)">删除</button>
                                            <div @click="item.enable=!item.enable"
                                                :class="{switch:true,active:item.enable}">
                                                <span class="switch-btn"></span>
                                            </div>
                                        </td>
                                    </tr>
                                    <!-- 测试设备2 -->
                                    <!-- <tr>
                                        <td>
                                            测试设备2
                                            <span class="equip-id">（ID: 1697420179352）</span>
                                        </td>
                                        <td>这是一个停用的设备</td>
                                        <td>127.0.0.2</td>
                                        <td>
                                            <button>删除</button>
                                            <div class="switch">
                                                <span class="switch-btn"></span>
                                            </div>
                                        </td>
                                    </tr> -->
                                </tbody>
                            </table>
                            <div class="no-data" v-else>暂无设备</div>
                        </div>
                        <!-- 设备数量 -->
                        <div class="equip-num">
                            共 2 台设备
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 新增弹层 -->
        <div class="dialog-bg" v-if="showDialog">
            <div class="dialog-content">
                <div class="dialog-title">
                    新增设备
                    <button class="dialog-close" @click="close">
                        <i></i>
                    </button>
                </div>
                <form action="/">
                    <div class="form-item">
                        <div class="form-label">
                            <label>设备名称</label>
                        </div>
                        <div class="form-control">
                            <input v-model="name" type="text" placeholder="请输入设备名称">
                        </div>
                    </div>
                    <div class="form-item">
                        <div class="form-label">
                            <label>设备IP</label>
                        </div>
                        <div class="form-control">
                            <input v-model="ip" type="text" placeholder="请输入设备IP">
                        </div>
                    </div>
                    <div class="form-item">
                        <div class="form-label">
                            <label>设备说明</label>
                        </div>
                        <div class="form-control">
                            <textarea v-model="remark" class="" name="info" placeholder="请输入设备说明"></textarea>
                        </div>
                    </div>
                    <div class="btn-wrap">
                        <button class="btn primary" @click.prevent="add">确定</button>
                        <button class="btn " @click="close">取消</button>
                    </div>
                </form>
            </div>

        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.14/dist/vue.js"></script>
    <script>
        // TODO：阅读代码，根据提供的数据，实现目标效果
        // DATA字段说明
        /**
         *  showDialog 是否显示新建弹层,true代表显示,false代表关闭
         *  equipList 设备列表
         *  name 设备名称
         *  remark 设备说明
         *  ip 设备ip
         *  id 设备id，新建设备时的毫秒数
         *  status 设备状态,true代表启动,false代表停用
        */
        let defaultList = [
            {
                name: '华南服务器1H1G',
                remark: '华南服务器',
                id: 1697420179351,
                ip: '49.38.27.16',
                enable: false

            },
            {
                name: '华北服务器1H2G',
                remark: '华北服务器',
                id: 1697420179352,
                ip: '49.38.27.17',
                enable: true

            }
        ]
        const app = new Vue({
            el: '#app',
            data: {
                value: '',
                name: '',
                remark: '',
                ip: '',
                showDialog: false,
                equipList: JSON.parse(localStorage.getItem('equipList')) == [] ? JSON.parse(localStorage.getItem('equipList')) : defaultList,
            },
            methods: {
                close() {
                    this.showDialog = !this.showDialog
                },
                add() {
                    this.showDialog = !this.showDialog
                    this.equipList.push({ id: +new Date(), name: this.name, remark: this.remark, ip: this.ip })
                },
                del(id) {
                    this.equipList = this.equipList.filter(item => item.id !== id)
                },
                search() {
                    console.log(defaultList);
                    defaultList = JSON.parse(localStorage.getItem('equipList'))
                    this.equipList = this.equipList.filter(item => item.name.includes(this.value))
                    console.log(defaultList);
                },
                cleanUp() {
                    console.log(defaultList);
                    this.value = ''
                    this.equipList = defaultList
                }
            },
            computed: {
                active: {
                    get() {
                        return this.equipList.every(item => item.enable === true)
                    },
                    set(flag) {
                        this.equipList.forEach(item => item.enable = flag)
                    }
                }
            },
            watch: {
                equipList: {
                    deep: true,
                    handler(newValue) {
                        localStorage.setItem('equipList', JSON.stringify(newValue))
                    }
                }
            }
        })
    </script>
</body>

</html>